<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Radio Program Schedule</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #3d6800;
            text-align: left;
            padding: 8px;
        }

        th {
            background-color: #95ff00;
        }

        td.upcoming,
        td.current,
        td.finished {
            background-color: inherit;
        }

        header {
            background-color: rgb(0, 176, 65);
            color: white;
            padding: 0.1px;
            text-align: center;
            position: fixed;
            width: 100%;
            top: 0;
        }

        .finished {
            background-color: #e57373;
        }

        .current {
            background-color: #81c784;
            animation: blink 2s infinite;
        }

        .upcoming {
            background-color: #64b5f6;
        }

        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Dynamic Radio Program Schedule</h1>
    </header>
    <br><br><br><br><br><br>
    <script>
        var programData = [
            // Day 1 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 1
            ],
            // Day 2 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Midnight Mix", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Dawn Crew", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 2
            ],
            // Day 3 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 3
            ],
            // Day 4 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 4
            ],
            // Day 5 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 5
            ],
            // Day 6 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 6
            ],
            // Day 7 programs
            [
                { time: "12:00 AM - 06:00 AM", program: "Xmas Muzic", presenter: "DJ Sserudigo", status: "Upcoming" },
                { time: "06:00 AM - 08:00 AM", program: "Wake Up", presenter: "Omulangira Ndausi", status: "Upcoming" },
                // ... add more programs for Day 7
            ],

        ];

        var audioPath = ""; // Update this path based on your project structure
        var currentProgram = ""; // Keep track of the current playing program

        // Define an array to store audio elements for each day and program
        var audioElements = {};

        // Map each day to its corresponding program audio map
        var programAudioMap = {
            "Day1": {
                "Xmas Muzic": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Xmas%20Muzic.mp3",
                "Wake Up": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Wake%20Up.mp3",
                // Add mappings for other programs on Day 1
            },
            "Day2": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 2
            },
            "Day3": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 3
            },
            "Day4": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 4
            },
            "Day5": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 4
            },
            "Day6": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 4
            },
            "Day7": {
                "Midnight Mix": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Midnight%20Mix.mp3",
                "Dawn Crew": "https://github.com/Fresh-Teacher/Fresh-FM/raw/main/Dawn%20Crew.mp3",
                // Add mappings for other programs on Day 4
            },
            // Add mappings for other days
        };

        function initializeAudioElements() {
            for (var dayIndex = 0; dayIndex < programData.length; dayIndex++) {
                for (var i = 0; i < programData[dayIndex].length; i++) {
                    var programName = programData[dayIndex][i].program;
                    var dayKey = "Day" + (dayIndex + 1);
                    var audioFileName = programAudioMap[dayKey][programName];
                    var audioSource = audioPath + audioFileName;

                    var audio = new Audio();
                    audio.src = audioSource;

                    // Store each audio element in the array
                    if (!audioElements[dayKey]) {
                        audioElements[dayKey] = {};
                    }
                    audioElements[dayKey][programName] = audio;
                }
            }
        }

        function updateStickyPlayer(dayIndex, programName) {
            var audioPlayer = document.getElementById('sticky-player');
            var audioSource = document.getElementById('audio-source');

            // If the current program is different, update the source and controls
            if (programName !== currentProgram) {
                currentProgram = programName;

                // Use the audio element from the array
                var dayKey = "Day" + (dayIndex + 1);
                var audio = audioElements[dayKey][currentProgram];

                // Set the audio source and play
                audioSource.src = audio.src;
                audioPlayer.load();
                audioPlayer.play();
            }
        }

        // Call the function to initialize audio elements
        initializeAudioElements();

        function generateProgramTable(dayIndex) {
            var programs = programData[dayIndex];

            var tableHTML = '<table>';
            tableHTML += '<tr><th>Time</th><th>Program</th><th>Presenter</th><th>Status</th></tr>';

            for (var i = 0; i < programs.length; i++) {
                tableHTML += '<tr>';
                tableHTML += `<td>${programs[i].time}</td>`;
                tableHTML += `<td>${programs[i].program}</td>`;
                tableHTML += `<td>${programs[i].presenter}</td>`;
                tableHTML += `<td class="${programs[i].status.toLowerCase()}">${programs[i].status}</td>`;
                tableHTML += '</tr>';
            }

            tableHTML += '</table>';
            return tableHTML;
        }

        // Function to get the current day index
        function getCurrentDayIndex() {
            var currentDate = new Date();
            var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            var currentDay = days[currentDate.getDay()];

            // Adjust for zero-based indexing in programData array
            return days.indexOf(currentDay);
        }

        // Function to display the table for the current day
        function displayCurrentDayTable() {
            var currentDayIndex = getCurrentDayIndex();
            var currentProgramTable = generateProgramTable(currentDayIndex);
            document.write(currentProgramTable);

            // Function to update the program status and sticky player controls every 10 seconds
            function updateProgramStatus() {
                var table = document.querySelector('table');
                var rows = table.getElementsByTagName("tr");

                for (var i = 1; i < rows.length; i++) {
                    var row = rows[i];
                    var timeCell = row.cells[0];
                    var statusCell = row.cells[3];

                    var programName = row.cells[1].innerText;
                    var programTime = timeCell.innerText.split(' - ');
                    var startTime = new Date(new Date().toLocaleDateString("en-US", { timeZone: "Africa/Nairobi" }) + " " + programTime[0]);
                    var endTime = new Date(new Date().toLocaleDateString("en-US", { timeZone: "Africa/Nairobi" }) + " " + programTime[1]);
                    var currentTime = new Date();

                    if (currentTime < startTime) {
                        row.className = "upcoming";
                        statusCell.innerText = "Upcoming";
                    } else if (currentTime >= startTime && currentTime <= endTime) {
                        row.className = "current";
                        statusCell.innerText = "LIVE";
                    } else {
                        row.className = "finished";
                        statusCell.innerText = "Ended";
                    }
                }

                // Update sticky player controls
                updateStickyPlayerControls();
            }

            // Function to update the sticky player controls and visibility
            function updateStickyPlayerControls() {
                var table = document.querySelector('table');
                var rows = table.getElementsByTagName("tr");

                for (var i = 1; i < rows.length; i++) {
                    var row = rows[i];
                    var timeCell = row.cells[0];

                    var programTime = timeCell.innerText.split(' - ');
                    var startTime = new Date(new Date().toLocaleDateString("en-US", { timeZone: "Africa/Nairobi" }) + " " + programTime[0]);
                    var endTime = new Date(new Date().toLocaleDateString("en-US", { timeZone: "Africa/Nairobi" }) + " " + programTime[1]);
                    var currentTime = new Date();

                    if (currentTime >= startTime && currentTime <= endTime) {
                        var programName = row.cells[1].innerText;
                        updateStickyPlayer(currentDayIndex, programName);
                        return;
                    }
                }

                // If no program is currently playing, hide the sticky player
                hideStickyPlayer();
            }

            // Function to update the sticky player source and controls
            function updateStickyPlayer(programName) {
                var audioPlayer = document.getElementById('sticky-player');
                var audioSource = document.getElementById('audio-source');

                // If the current program is different, update the source and controls
                if (programName !== currentProgram) {
                    currentProgram = programName;

                    // Use the audio element from the array
                    var dayKey = "Day" + (getCurrentDayIndex() + 1);
                    var audio = audioElements[dayKey][currentProgram];

                    // Set the audio source and play
                    audioSource.src = audio.src;
                    audioPlayer.load();
                    audioPlayer.play();
                }
            }

            // Function to hide the sticky player if no program is currently playing
            function hideStickyPlayer() {
                var audioPlayer = document.getElementById('sticky-player');

            audioPlayer.pause();
            audioPlayer.style.display = "none";
        }

        // Initialize the sticky player controls
        function initializeStickyPlayer() {
            var audioPlayer = document.getElementById('sticky-player');
            var audioSource = document.getElementById('audio-source');

            audioPlayer.addEventListener('ended', function () {
                // When the audio ends, update the program status and sticky player controls
                updateProgramStatus();
            });

            audioPlayer.addEventListener('pause', function () {
                // When the audio is paused, update the program status and sticky player controls
                updateProgramStatus();
            });
        }

        // Call the initializations
        initializeStickyPlayer();
        setInterval(updateProgramStatus, 10000); // Update every 10 seconds
    </script>

    <!-- Sticky Player -->
    <div id="sticky-player" style="position: fixed; bottom: 0; left: 0; width: 100%; background-color: #f1f1f1; padding: 10px; display: none;">
        <audio id="audio-source" controls style="width: 100%;">
            Your browser does not support the audio element.
        </audio>
    </div>
</body>

</html>
